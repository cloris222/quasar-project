import{l as U,c as s,h as g,af as M,r as E,g as $,a0 as X,z as B,q as Y,a2 as G,ac as H}from"./index.61b5a61b.js";import{u as J,b as Z,c as ee}from"./QTable.3338e6e8.js";import{Q as te}from"./QChip.3035cb6c.js";import{u as ne,a as le,b as ie,d as ae,c as ue,f as w,e as re}from"./use-key-composition.a0ab30d2.js";import{u as oe}from"./QForm.f66cfea4.js";import{h as se}from"./format.3e32b8d9.js";var Fe=U({name:"QToggle",props:{...J,icon:String,iconColor:String},emits:Z,setup(e){function c(p,h){const a=s(()=>(p.value===!0?e.checkedIcon:h.value===!0?e.indeterminateIcon:e.uncheckedIcon)||e.icon),r=s(()=>p.value===!0?e.iconColor:null);return()=>[g("div",{class:"q-toggle__track"}),g("div",{class:"q-toggle__thumb absolute flex flex-center no-wrap"},a.value!==void 0?[g(M,{name:a.value,color:r.value})]:void 0)]}return ee("toggle",c)}});function y(e,c,p,h){const a=[];return e.forEach(r=>{h(r)===!0?a.push(r):c.push({failedPropValidation:p,file:r})}),a}function P(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),B(e)}const ce={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},fe=["rejected"];function de({editable:e,dnd:c,getFileInput:p,addFilesToQueue:h}){const{props:a,emit:r,proxy:F}=$(),x=E(null),z=s(()=>a.accept!==void 0?a.accept.split(",").map(t=>(t=t.trim(),t==="*"?"*/":(t.endsWith("/*")&&(t=t.slice(0,t.length-1)),t.toUpperCase()))):null),_=s(()=>parseInt(a.maxFiles,10)),k=s(()=>parseInt(a.maxTotalSize,10));function V(t){if(e.value)if(t!==Object(t)&&(t={target:null}),t.target!==null&&t.target.matches('input[type="file"]')===!0)t.clientX===0&&t.clientY===0&&X(t);else{const m=p();m&&m!==t.target&&m.click(t)}}function I(t){e.value&&t&&h(null,t)}function A(t,m,S,C){let l=Array.from(m||t.target.files);const d=[],b=()=>{d.length>0&&r("rejected",d)};if(a.accept!==void 0&&z.value.indexOf("*/")===-1&&(l=y(l,d,"accept",i=>z.value.some(o=>i.type.toUpperCase().startsWith(o)||i.name.toUpperCase().endsWith(o))),l.length===0))return b();if(a.maxFileSize!==void 0){const i=parseInt(a.maxFileSize,10);if(l=y(l,d,"max-file-size",o=>o.size<=i),l.length===0)return b()}if(a.multiple!==!0&&l.length>0&&(l=[l[0]]),l.forEach(i=>{i.__key=i.webkitRelativePath+i.lastModified+i.name+i.size}),C===!0){const i=S.map(o=>o.__key);l=y(l,d,"duplicate",o=>i.includes(o.__key)===!1)}if(l.length===0)return b();if(a.maxTotalSize!==void 0){let i=C===!0?S.reduce((o,T)=>o+T.size,0):0;if(l=y(l,d,"max-total-size",o=>(i+=o.size,i<=k.value)),l.length===0)return b()}if(typeof a.filter=="function"){const i=a.filter(l);l=y(l,d,"filter",o=>i.includes(o))}if(a.maxFiles!==void 0){let i=C===!0?S.length:0;if(l=y(l,d,"max-files",()=>(i++,i<=_.value)),l.length===0)return b()}if(b(),l.length>0)return l}function D(t){P(t),c.value!==!0&&(c.value=!0)}function u(t){B(t),(t.relatedTarget!==null||Y.is.safari!==!0?t.relatedTarget!==x.value:document.elementsFromPoint(t.clientX,t.clientY).includes(x.value)===!1)===!0&&(c.value=!1)}function j(t){P(t);const m=t.dataTransfer.files;m.length>0&&h(null,m),c.value=!1}function q(t){if(c.value===!0)return g("div",{ref:x,class:`q-${t}__dnd absolute-full`,onDragenter:P,onDragover:P,onDragleave:u,onDrop:j})}return Object.assign(F,{pickFiles:V,addFiles:I}),{pickFiles:V,addFiles:I,onDragover:D,onDragleave:u,processFiles:A,getDndNode:q,maxFilesNumber:_,maxTotalSizeNumber:k}}var xe=U({name:"QFile",inheritAttrs:!1,props:{...ne,...le,...ce,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...ie,...fe],setup(e,{slots:c,emit:p,attrs:h}){const{proxy:a}=$(),r=ae(),F=E(null),x=E(!1),z=ue(e),{pickFiles:_,onDragover:k,onDragleave:V,processFiles:I,getDndNode:A}=de({editable:r.editable,dnd:x,getFileInput:Q,addFilesToQueue:R}),D=oe(e),u=s(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),j=s(()=>w(u.value)),q=s(()=>u.value.map(n=>n.name).join(", ")),t=s(()=>se(u.value.reduce((n,f)=>n+f.size,0))),m=s(()=>({totalSize:t.value,filesNumber:u.value.length,maxFiles:e.maxFiles})),S=s(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:z.value,...h,id:r.targetUid.value,disabled:r.editable.value!==!0})),C=s(()=>"q-file q-field--auto-height"+(x.value===!0?" q-file--dnd":"")),l=s(()=>e.multiple===!0&&e.append===!0);function d(n){const f=u.value.slice();f.splice(n,1),i(f)}function b(n){const f=u.value.findIndex(n);f>-1&&d(f)}function i(n){p("update:modelValue",e.multiple===!0?n:n[0])}function o(n){n.keyCode===13&&H(n)}function T(n){(n.keyCode===13||n.keyCode===32)&&_(n)}function Q(){return F.value}function R(n,f){const v=I(n,f,u.value,l.value),O=Q();O!=null&&(O.value=""),v!==void 0&&((e.multiple===!0?e.modelValue&&v.every(K=>u.value.includes(K)):e.modelValue===v[0])||i(l.value===!0?u.value.concat(v):v))}function N(){return[g("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function L(){if(c.file!==void 0)return u.value.length===0?N():u.value.map((f,v)=>c.file({index:v,file:f,ref:this}));if(c.selected!==void 0)return u.value.length===0?N():c.selected({files:u.value,ref:this});if(e.useChips===!0)return u.value.length===0?N():u.value.map((f,v)=>g(te,{key:"file-"+v,removable:r.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{d(v)}},()=>g("span",{class:"ellipsis",textContent:f.name})));const n=e.displayValue!==void 0?e.displayValue:q.value;return n.length>0?[g("div",{class:e.inputClass,style:e.inputStyle,textContent:n})]:N()}function W(){const n={ref:F,...S.value,...D.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:R};return e.multiple===!0&&(n.multiple=!0),g("input",n)}return Object.assign(r,{fieldClass:C,emitValue:i,hasValue:j,inputRef:F,innerValue:u,floatingLabel:s(()=>j.value===!0||w(e.displayValue)),computedCounter:s(()=>{if(e.counterLabel!==void 0)return e.counterLabel(m.value);const n=e.maxFiles;return`${u.value.length}${n!==void 0?" / "+n:""} (${t.value})`}),getControlChild:()=>A("file"),getControl:()=>{const n={ref:r.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return r.editable.value===!0&&Object.assign(n,{onDragover:k,onDragleave:V,onKeydown:o,onKeyup:T}),g("div",n,[W()].concat(L()))}}),Object.assign(a,{removeAtIndex:d,removeFile:b,getNativeElement:()=>F.value}),G(a,"nativeEl",()=>F.value),re(r)}});export{Fe as Q,xe as a};
